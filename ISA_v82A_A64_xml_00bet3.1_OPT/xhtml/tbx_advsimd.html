<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><link rel="stylesheet" type="text/css" href="insn.css" /><meta name="generator" content="iform.xsl" /><title>TBX -- A64</title></head><body><table align="center"><tr><td><div class="topbar"><a href="index.html">Base Instructions</a></div></td><td><div class="topbar"><a href="fpsimdindex.html">SIMD&amp;FP Instructions</a></div></td><td><div class="topbar"><a href="encodingindex.html">Index by Encoding</a></div></td><td><div class="topbar"><a href="permindex.html">Permuted Index</a></div></td><td><div class="topbar"><a href="shared_pseudocode.html">Shared Pseudocode</a></div></td><td><div class="topbar"><a href="notice.html">Proprietary Notice</a></div></td></tr></table><hr /><h2 class="instruction-section">TBX</h2><p id="desc">
      <p class="aml">Table vector lookup extension. This instruction reads each value from the vector elements in the index source SIMD&amp;FP register, uses each result as an index to perform a lookup in a table of bytes that is described by one to four source table SIMD&amp;FP registers, places the lookup result in a vector, and writes the vector to the destination SIMD&amp;FP register. If an index is out of range for the table, the existing value in the vector element of the destination register is left unchanged. If more than one source register is used to describe the table, the first source register describes the lowest bytes of the table.</p>
      <p class="aml">Depending on the settings in the <a class="armarm-xref" title="Reference to ARM ARM section">CPACR_EL1</a>, <a class="armarm-xref" title="Reference to ARM ARM section">CPTR_EL2</a>, and <a class="armarm-xref" title="Reference to ARM ARM section">CPTR_EL3</a> registers, and the current Security state and Exception level, an attempt to execute the instruction might be trapped.</p>
    </p>
    <p class="desc"></p><div class="regdiagram-32"><table class="regdiagram"><thead><tr><td>31</td><td>30</td><td>29</td><td>28</td><td>27</td><td>26</td><td>25</td><td>24</td><td>23</td><td>22</td><td>21</td><td>20</td><td>19</td><td>18</td><td>17</td><td>16</td><td>15</td><td>14</td><td>13</td><td>12</td><td>11</td><td>10</td><td>9</td><td>8</td><td>7</td><td>6</td><td>5</td><td>4</td><td>3</td><td>2</td><td>1</td><td>0</td></tr></thead><tbody><tr class="firstrow"><td class="lr">0</td><td class="lr">Q</td><td class="l">0</td><td>0</td><td>1</td><td>1</td><td>1</td><td class="r">0</td><td class="l">0</td><td class="r">0</td><td class="lr">0</td><td colspan="5" class="lr">Rm</td><td class="lr">0</td><td colspan="2" class="lr">len</td><td class="lr">1</td><td class="l">0</td><td class="r">0</td><td colspan="5" class="lr">Rn</td><td colspan="5" class="lr">Rd</td></tr><tr class="secondrow"><td></td><td></td><td colspan="6"></td><td colspan="2"></td><td></td><td colspan="5"></td><td></td><td colspan="2"></td><td class="droppedname">op</td><td colspan="2"></td><td colspan="5"></td><td colspan="5"></td></tr></tbody></table></div><div class="encoding"><h4 class="encoding">Two register table<span class="bitdiff"> (len == 01)</span></h4><p class="asm-code"><a name="TBX_asimdtbl_L2_2" id="TBX_asimdtbl_L2_2">TBX  <a href="#vd" title="SIMD&amp;FP destination register (field &quot;Rd&quot;)">&lt;Vd&gt;</a>.<a href="#ta" title="Arrangement specifier (field &quot;Q&quot;) [8B,16B]">&lt;Ta&gt;</a>, { <a href="#vn_1" title="First SIMD&amp;FP table register (field &quot;Rn&quot;)">&lt;Vn&gt;</a>.16B, <a href="#vn_plus_1" title="Second SIMD&amp;FP table register, encoded as &quot;Rn&quot; plus 1 modulo 32 (field Rn)">&lt;Vn+1&gt;</a>.16B }, <a href="#vm" title="SIMD&amp;FP index register (field &quot;Rm&quot;)">&lt;Vm&gt;</a>.<a href="#ta" title="Arrangement specifier (field &quot;Q&quot;) [8B,16B]">&lt;Ta&gt;</a></a></p></div><div class="encoding"><h4 class="encoding">Three register table<span class="bitdiff"> (len == 10)</span></h4><p class="asm-code"><a name="TBX_asimdtbl_L3_3" id="TBX_asimdtbl_L3_3">TBX  <a href="#vd" title="SIMD&amp;FP destination register (field &quot;Rd&quot;)">&lt;Vd&gt;</a>.<a href="#ta" title="Arrangement specifier (field &quot;Q&quot;) [8B,16B]">&lt;Ta&gt;</a>, { <a href="#vn_1" title="First SIMD&amp;FP table register (field &quot;Rn&quot;)">&lt;Vn&gt;</a>.16B, <a href="#vn_plus_1" title="Second SIMD&amp;FP table register, encoded as &quot;Rn&quot; plus 1 modulo 32 (field Rn)">&lt;Vn+1&gt;</a>.16B, <a href="#vn_plus_2" title="Third SIMD&amp;FP table register, encoded as &quot;Rn&quot; plus 2 modulo 32 (field Rn)">&lt;Vn+2&gt;</a>.16B }, <a href="#vm" title="SIMD&amp;FP index register (field &quot;Rm&quot;)">&lt;Vm&gt;</a>.<a href="#ta" title="Arrangement specifier (field &quot;Q&quot;) [8B,16B]">&lt;Ta&gt;</a></a></p></div><div class="encoding"><h4 class="encoding">Four register table<span class="bitdiff"> (len == 11)</span></h4><p class="asm-code"><a name="TBX_asimdtbl_L4_4" id="TBX_asimdtbl_L4_4">TBX  <a href="#vd" title="SIMD&amp;FP destination register (field &quot;Rd&quot;)">&lt;Vd&gt;</a>.<a href="#ta" title="Arrangement specifier (field &quot;Q&quot;) [8B,16B]">&lt;Ta&gt;</a>, { <a href="#vn_1" title="First SIMD&amp;FP table register (field &quot;Rn&quot;)">&lt;Vn&gt;</a>.16B, <a href="#vn_plus_1" title="Second SIMD&amp;FP table register, encoded as &quot;Rn&quot; plus 1 modulo 32 (field Rn)">&lt;Vn+1&gt;</a>.16B, <a href="#vn_plus_2" title="Third SIMD&amp;FP table register, encoded as &quot;Rn&quot; plus 2 modulo 32 (field Rn)">&lt;Vn+2&gt;</a>.16B, <a href="#vn_plus_3" title="Fourth SIMD&amp;FP table register, encoded as &quot;Rn&quot; plus 3 modulo 32 (field Rn)">&lt;Vn+3&gt;</a>.16B }, <a href="#vm" title="SIMD&amp;FP index register (field &quot;Rm&quot;)">&lt;Vm&gt;</a>.<a href="#ta" title="Arrangement specifier (field &quot;Q&quot;) [8B,16B]">&lt;Ta&gt;</a></a></p></div><div class="encoding"><h4 class="encoding">Single register table<span class="bitdiff"> (len == 00)</span></h4><p class="asm-code"><a name="TBX_asimdtbl_L1_1" id="TBX_asimdtbl_L1_1">TBX  <a href="#vd" title="SIMD&amp;FP destination register (field &quot;Rd&quot;)">&lt;Vd&gt;</a>.<a href="#ta" title="Arrangement specifier (field &quot;Q&quot;) [8B,16B]">&lt;Ta&gt;</a>, { <a href="#vn" title="SIMD&amp;FP table register (field &quot;Rn&quot;)">&lt;Vn&gt;</a>.16B }, <a href="#vm" title="SIMD&amp;FP index register (field &quot;Rm&quot;)">&lt;Vm&gt;</a>.<a href="#ta" title="Arrangement specifier (field &quot;Q&quot;) [8B,16B]">&lt;Ta&gt;</a></a></p></div><p class="pseudocode">integer d = <a href="shared_pseudocode.html#impl-shared.UInt.1" title="function: integer UInt(bits(N) x)">UInt</a>(Rd);
integer n = <a href="shared_pseudocode.html#impl-shared.UInt.1" title="function: integer UInt(bits(N) x)">UInt</a>(Rn);
integer m = <a href="shared_pseudocode.html#impl-shared.UInt.1" title="function: integer UInt(bits(N) x)">UInt</a>(Rm);

integer datasize = if Q == '1' then 128 else 64;
integer elements = datasize DIV 8;
integer regs = <a href="shared_pseudocode.html#impl-shared.UInt.1" title="function: integer UInt(bits(N) x)">UInt</a>(len) + 1;
boolean is_tbl = (op == '0');</p>
  <p class="encoding-notes"></p><h3 class="explanations">Assembler Symbols</h3><div class="explanations"><table><col class="asyn-l" /><col class="asyn-r" /><tr><td>&lt;Vd&gt;</td><td><a name="vd" id="vd">
        
          <p class="aml">Is the name of the SIMD&amp;FP destination register, encoded in the "Rd" field.</p>
        
      </a></td></tr></table><table><col class="asyn-l" /><col class="asyn-r" /><tr><td>&lt;Ta&gt;</td><td><a name="ta" id="ta">
        Is an arrangement specifier, 
    encoded in 
    <q>Q</q>:
      
        <table class="valuetable">
          
            <thead>
              <tr>
                <th class="bitfield">Q</th>
                <th class="symbol">&lt;Ta&gt;</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="bitfield">0</td>
                <td class="symbol">8B</td>
              </tr>
              <tr>
                <td class="bitfield">1</td>
                <td class="symbol">16B</td>
              </tr>
            </tbody>
          
        </table>
      </a></td></tr></table><table><col class="asyn-l" /><col class="asyn-r" /><tr><td>&lt;Vn&gt;</td><td><a name="vn_1" id="vn_1">
        
          <p class="aml">For the four register table, three register table and two register table variant: is the name of the first SIMD&amp;FP table register, encoded in the "Rn" field.</p>
        
      </a></td></tr><tr><td></td><td><a name="vn" id="vn">
        
          
        
        
          <p class="aml">For the single register table variant: is the name of the SIMD&amp;FP table register, encoded in the "Rn" field.</p>
        
      </a></td></tr></table><table><col class="asyn-l" /><col class="asyn-r" /><tr><td>&lt;Vn+1&gt;</td><td><a name="vn_plus_1" id="vn_plus_1">
        
          <p class="aml">Is the name of the second SIMD&amp;FP table register, encoded as "Rn" plus 1 modulo 32.</p>
        
      </a></td></tr></table><table><col class="asyn-l" /><col class="asyn-r" /><tr><td>&lt;Vn+2&gt;</td><td><a name="vn_plus_2" id="vn_plus_2">
        
          <p class="aml">Is the name of the third SIMD&amp;FP table register, encoded as "Rn" plus 2 modulo 32.</p>
        
      </a></td></tr></table><table><col class="asyn-l" /><col class="asyn-r" /><tr><td>&lt;Vn+3&gt;</td><td><a name="vn_plus_3" id="vn_plus_3">
        
          <p class="aml">Is the name of the fourth SIMD&amp;FP table register, encoded as "Rn" plus 3 modulo 32.</p>
        
      </a></td></tr></table><table><col class="asyn-l" /><col class="asyn-r" /><tr><td>&lt;Vm&gt;</td><td><a name="vm" id="vm">
        
          <p class="aml">Is the name of the SIMD&amp;FP index register, encoded in the "Rm" field.</p>
        
      </a></td></tr></table></div><p class="syntax-notes"></p>
    <div class="ps" psname="commonps"><a name="commonps" id="commonps"></a><h3 class="pseudocode">Operation</h3>
      <p class="pseudocode"><a href="shared_pseudocode.html#impl-aarch64.CheckFPAdvSIMDEnabled64.0" title="function: CheckFPAdvSIMDEnabled64()">CheckFPAdvSIMDEnabled64</a>();
bits(datasize) indices = <a href="shared_pseudocode.html#impl-aarch64.V.read.1" title="accessor: bits(width) V[integer n]">V</a>[m];
bits(128*regs) table = <a href="shared_pseudocode.html#impl-shared.Zeros.0" title="function: bits(N) Zeros()">Zeros</a>();
bits(datasize) result;
integer index;
integer i;

// Create table from registers
for i = 0 to regs-1
    table&lt;128*i+127:128*i&gt; = <a href="shared_pseudocode.html#impl-aarch64.V.read.1" title="accessor: bits(width) V[integer n]">V</a>[n];
    n = (n + 1) MOD 32;

result = if is_tbl then <a href="shared_pseudocode.html#impl-shared.Zeros.0" title="function: bits(N) Zeros()">Zeros</a>() else <a href="shared_pseudocode.html#impl-aarch64.V.read.1" title="accessor: bits(width) V[integer n]">V</a>[d];
for i = 0 to elements-1
    index = <a href="shared_pseudocode.html#impl-shared.UInt.1" title="function: integer UInt(bits(N) x)">UInt</a>(<a href="shared_pseudocode.html#impl-shared.Elem.read.3" title="accessor: bits(size) Elem[bits(N) vector, integer e, integer size]">Elem</a>[indices, i, 8]);
    if index &lt; 16 * regs then
        <a href="shared_pseudocode.html#impl-shared.Elem.write.3" title="accessor: Elem[bits(N) &amp;vector, integer e, integer size] = bits(size) value">Elem</a>[result, i, 8] = <a href="shared_pseudocode.html#impl-shared.Elem.read.3" title="accessor: bits(size) Elem[bits(N) vector, integer e, integer size]">Elem</a>[table, index, 8];

<a href="shared_pseudocode.html#impl-aarch64.V.write.1" title="accessor: V[integer n] = bits(width) value">V</a>[d] = result;</p>
    </div>
  <hr /><table align="center"><tr><td><div class="topbar"><a href="index.html">Base Instructions</a></div></td><td><div class="topbar"><a href="fpsimdindex.html">SIMD&amp;FP Instructions</a></div></td><td><div class="topbar"><a href="encodingindex.html">Index by Encoding</a></div></td><td><div class="topbar"><a href="permindex.html">Permuted Index</a></div></td><td><div class="topbar"><a href="shared_pseudocode.html">Shared Pseudocode</a></div></td><td><div class="topbar"><a href="notice.html">Proprietary Notice</a></div></td></tr></table><p class="versions">
      Internal version only: isa v25.07, AdvSIMD v23.0, pseudocode v31.3
    </p><p class="copyconf">
      Copyright © 2010-2017 ARM Limited or its affiliates. All rights reserved.
      This document is Confidential.
    </p></body></html>
